=== Bug Context ===
The bug is in Linuxâ€™s seq_file interface. which could lead to an out-of-bounds write. This vulnerability allows a local attacker with user-level privileges to modify memory outside the bounds of the intended buffer, potentially resulting in a system crash or leakage of internal kernel information. The root cause of this issue lies in the failure to properly validate the size_t-to-int conversion in the seq_file.c, leading to the possibility of writing beyond the intended memory boundaries. 

The mountinfo file serves as an example of a seq_file, which is a virtual file used by the Linux kernel to present a sequence of records. Each record in a seq_file must fit into a buffer, whose size is tracked as a size_t, a 64-bit unsigned value. The issue arises in the show_mountinfo function when a very long mountpoint path (longer than 1GB, or INT_MAX/2 + 1) is used, and the process expects an int as the buffer length, which is a 32-bit signed value, as shown in the following chain: show_mountinfo() -> seq_dentry() -> dentry_path() -> prepand() where a size_t is converted to int, resulting in a negative value (INT_MIN). This negative value is later used as an offset to write the string "//deleted" outside the allocated buffer when the mountpoint is still in use but the path has been deleted. As a result, the write occurs at an offset between 2GB and 10 bytes before the intended buffer location.


=== Usage ===
exploit:
    gcc my_crasher.c -o my_crasher

patch:
    module add arm-rpi
    LINUX_SOURCE=path to the Linux kernel source code
    make -C $LINUX_SOURCE ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- M=$PWD modules